% Script generated by Brainstorm v3.1 (15-Jan-2014)

% Input files
sFiles = [];
SubjectNames = {...
    'Subject01_copy'};
RawFiles = {...
    '/home/foldes/Data/MEG/DBI05/S01/dbi05s01r14_tsss.fif'};

% Start a new report
bst_report('Start', sFiles);

% Process: Create link to raw file
sFiles = bst_process(...
    'CallProcess', 'process_import_data_raw', ...
    sFiles, [], ...
    'subjectname', SubjectNames{1}, ...
    'datafile', {RawFiles{1}, 'FIF'}, ...
    'channelreplace', 1, ...
    'channelalign', 1);

% Process: Detect eye blinks
sFiles = bst_process(...
    'CallProcess', 'process_evt_detect_eog', ...
    sFiles, [], ...
    'channelname', 'EOG062', ...
    'timewindow', [18, 208.999], ...
    'eventname', 'blink');

% Process: SSP EOG: blink
sFiles = bst_process(...
    'CallProcess', 'process_ssp_eog', ...
    sFiles, [], ...
    'eventname', 'blink', ...
    'sensortypes', 'MEG, MEG MAG, MEG GRAD');

% Process: Detect heartbeats
sFiles = bst_process(...
    'CallProcess', 'process_evt_detect_ecg', ...
    sFiles, [], ...
    'channelname', 'ECG063', ...
    'timewindow', [18, 208.999], ...
    'eventname', 'cardiac');

% Process: SSP ECG: cardiac
sFiles = bst_process(...
    'CallProcess', 'process_ssp_ecg', ...
    sFiles, [], ...
    'eventname', 'cardiac', ...
    'sensortypes', 'MEG, MEG MAG, MEG GRAD');

% Process: Events: Read from channel
sFiles = bst_process(...
    'CallProcess', 'process_evt_read', ...
    sFiles, [], ...
    'stimchan', 'STI101', ...
    'trackmode', 1, ...  % Value: detect the changes of channel value
    'zero', 0);

% Process: Import MEG/EEG: Events
sFiles = bst_process(...
    'CallProcess', 'process_import_data_event', ...
    sFiles, [], ...
    'subjectname', SubjectNames{1}, ...
    'condition', 'MNS', ...
    'eventname', '1', ...
    'timewindow', [18, 208.999], ...
    'epochtime', [-0.1, 0.2], ...
    'createcond', 1, ...
    'ignoreshort', 1, ...
    'usectfcomp', 1, ...
    'usessp', 1, ...
    'freq', [], ...
    'baseline', []);

% Save and display report
ReportFile = bst_report('Save', sFiles);
bst_report('Open', ReportFile);

